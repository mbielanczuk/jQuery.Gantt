(function(d){d.fn.gantt=function(G){function H(a,b){for(var c=1;;c++){var d=new Date(a);d.setHours(a.getHours()+b*c);if(d.getTime()!==a.getTime())return d}}var C=["hours","days","weeks","months"],f={source:[],itemsPerPage:7,months:"January February March April May June July August September October November December".split(" "),dow:"SMTWTFS".split(""),startPos:new Date,navigate:"buttons",scale:"days",useCookie:!1,maxScale:"months",minScale:"hours",waitText:"Please wait...",onItemClick:function(a){},
onAddClick:function(a){},onRender:function(){},onDataLoadFailed:function(a){},scrollToToday:!0};G&&d.extend(f,G);f.useCookie=f.useCookie&&d.isFunction(d.cookie);d.extend(d.expr[":"],{findday:function(a,b,c){b=new Date(parseInt(c[3],10));a=(a=d(a).attr("id"))?a:"";c=a.indexOf("-")+1;a=new Date(parseInt(a.substring(c,a.length),10));b=new Date(b.getFullYear(),b.getMonth(),b.getDate());a=new Date(a.getFullYear(),a.getMonth(),a.getDate());return b.getTime()===a.getTime()}});d.extend(d.expr[":"],{findweek:function(a,
b,c){b=new Date(parseInt(c[3],10));a=(a=d(a).attr("id"))?a:"";c=a.indexOf("-")+1;b=b.getFullYear()+"-"+b.getDayForWeek().getWeekOfYear();a=a.substring(c,a.length);return b===a}});d.extend(d.expr[":"],{findmonth:function(a,b,c){b=new Date(parseInt(c[3],10));b=b.getFullYear()+"-"+b.getMonth();a=(a=d(a).attr("id"))?a:"";c=a.indexOf("-")+1;a=a.substring(c,a.length);return b===a}});Date.prototype.getWeekId=function(){var a=this.getFullYear(),b=this.getDayForWeek().getWeekOfYear();11===this.getMonth()&&
1===b&&a++;return"dh-"+a+"-"+b};Date.prototype.getRepDate=function(){switch(f.scale){case "hours":return this.getTime();case "weeks":return this.getDayForWeek().getTime();case "months":return(new Date(this.getFullYear(),this.getMonth(),1)).getTime();default:return this.getTime()}};Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),0,0),b=new Date(this.getFullYear(),this.getMonth(),this.getDate());return Math.ceil((b-a)/864E5)};Date.prototype.getWeekOfYear=function(){var a=new Date(this.getFullYear(),
0,1),b=new Date(this.getTime());b.setDate(b.getDate()+4-(b.getDay()||7));return Math.floor(Math.round((b-a)/864E5)/7)+1};Date.prototype.getDaysInMonth=function(){return 32-(new Date(this.getFullYear(),this.getMonth(),32)).getDate()};Date.prototype.hasWeek=function(){var a=new Date(this.valueOf());a.setDate(a.getDate()-a.getDay());var b=new Date(this.valueOf());b.setDate(b.getDate()+(6-b.getDay()));return a.getMonth()===b.getMonth()?!0:a.getMonth()===this.getMonth()&&4>b.getDate()||a.getMonth()!==
this.getMonth()&&4<=b.getDate()};Date.prototype.getDayForWeek=function(){var a=new Date(this.valueOf());a.setDate(a.getDate()-a.getDay());var b=new Date(this.valueOf());b.setDate(b.getDate()+(6-b.getDay()));return a.getMonth()===b.getMonth()||a.getMonth()!==b.getMonth()&&4<=b.getDate()?new Date(b.setDate(b.getDate()-3)):new Date(a.setDate(a.getDate()+3))};var g={elementFromPoint:function(a,b){d.support.boxModel?(a-=window.pageXOffset,b-=window.pageYOffset):(a-=d(document).scrollLeft(),b-=d(document).scrollTop());
return document.elementFromPoint(a,b)},create:function(a){"string"!==typeof f.source?(a.data=f.source,g.init(a)):d.getJSON(f.source,function(b){a.data=b;g.init(a)})},init:function(a){try{a.rowsNum=a.data.length,a.pageCount=Math.ceil(a.rowsNum/f.itemsPerPage),a.rowsOnLastPage=a.rowsNum-Math.floor(a.rowsNum/f.itemsPerPage)*f.itemsPerPage,a.dateStart=e.getMinDate(a),a.dateEnd=e.getMaxDate(a),g.waitToggle(a,!0,function(){g.render(a)})}catch(b){if(null===a.data||"object"===typeof a.data&&0===a.data.length)f.onDataLoadFailed(d(this).data("dataObj"))}},
render:function(a){var b=d('<div class="fn-content"/>'),c=g.leftPanel(a);b.append(c);var p=g.rightPanel(a,c);b.append(p);b.append(g.navigation(a));var e=p.find(".dataPanel");a.gantt=d('<div class="fn-gantt" />').append(b);d(a).html(a.gantt);a.scrollNavigation.panelMargin=parseInt(e.css("margin-left").replace("px",""),10);a.scrollNavigation.panelMaxPos=e.width()-p.width();a.scrollNavigation.canScroll=e.width()>p.width();g.markNow(a);g.fillData(a,e,c);f.useCookie&&(b=d.cookie(this.cookieKey+"ScrollPos"))&&
(a.hPosition=b);f.scrollToToday?(g.navigateTo(a,"now"),g.scrollPanel(a,0)):0!==a.hPosition&&(a.scaleOldWidth?(p=e.width()-p.width(),p=p*a.hPosition/a.scaleOldWidth,p=0<p?0:p,e.css({"margin-left":p+"px"}),a.scrollNavigation.panelMargin=p,a.hPosition=p,a.scaleOldWidth=null):(e.css({"margin-left":a.hPosition+"px"}),a.scrollNavigation.panelMargin=a.hPosition),g.repositionLabel(a));e.css({height:c.height()});g.waitToggle(a,!1);f.onRender()},leftPanel:function(a){var b=d('<div class="leftPanel"/>').append(d('<div class="row spacer"/>').css("height",
e.getCellSize()*a.headerRows+"px").css("width","100%")),c=[];d.each(a.data,function(b,d){b>=a.pageNum*f.itemsPerPage&&b<a.pageNum*f.itemsPerPage+f.itemsPerPage&&(c.push('<div class="row name row'+b+(d.desc?"":" fn-wide")+'" id="rowheader'+b+'" offset="'+b%f.itemsPerPage*e.getCellSize()+'">'),c.push('<span class="fn-label'+(d.cssClass?" "+d.cssClass:"")+'">'+(d.name||"")+"</span>"),c.push("</div>"),d.desc&&(c.push('<div class="row desc row'+b+' " id="RowdId_'+b+'" data-id="'+d.id+'">'),c.push('<span class="fn-label'+
(d.cssClass?" "+d.cssClass:"")+'">'+d.desc+"</span>"),c.push("</div>")))});b.append(c.join(""));return b},dataPanel:function(a,b){var c=d('<div class="dataPanel" style="width: '+b+'px;"/>'),p=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";document.attachEvent?a.attachEvent("on"+p,function(b){g.wheelScroll(a,b)}):document.addEventListener&&a.addEventListener(p,function(b){g.wheelScroll(a,b)},!1);c.click(function(b){b.stopPropagation();var c,p=d(a).find(".fn-gantt .leftPanel"),h=
d(a).find(".fn-gantt .dataPanel");switch(f.scale){case "weeks":c=2*e.getCellSize();break;case "months":c=e.getCellSize();break;case "hours":c=4*e.getCellSize();break;case "days":c=3*e.getCellSize();break;default:c=2*e.getCellSize()}c=g.elementFromPoint(b.pageX,h.offset().top+c);c="fn-label"===c.className?d(c.parentNode):d(c);c=c.attr("repdate");b=g.elementFromPoint(p.offset().left+p.width()-10,b.pageY);b=0===b.className.indexOf("fn-label")?d(b.parentNode):d(b);b=b.data().id;f.onAddClick(c,b)});return c},
rightPanel:function(a,b){var c=null,p="sn wd wd wd wd wd sa".split(" "),r=['<div class="row"/>'],n=0,l=['<div class="row"/>'],h=0,k=[],q=0,x=[],A=[],B=new Date,B=new Date(B.getFullYear(),B.getMonth(),B.getDate()),F=f.holidays?f.holidays.join():"";switch(f.scale){case "hours":for(var c=e.parseTimeRange(a.dateStart,a.dateEnd,a.scaleStep),t=c[0].getFullYear(),v=c[0].getMonth(),w=c[0],u=0,D=c.length;u<D;u++){var m=c[u],y=m.getFullYear();y!==t&&(r.push('<div class="row header year" style="width: '+e.getCellSize()*
n+'px;"><div class="fn-label">'+t+"</div></div>"),t=y,n=0);n++;y=m.getMonth();y!==v&&(l.push('<div class="row header month" style="width: '+e.getCellSize()*h+'px"><div class="fn-label">'+f.months[v]+"</div></div>"),v=y,h=0);h++;var E=m.getDay(),y=w.getDay(),z=p[E],C=w.getTime();-1<F.indexOf((new Date(m.getFullYear(),m.getMonth(),m.getDate())).getTime())&&(z="holiday");E!==y&&(E=0===B-w?" today":-1<F.indexOf(C)?"holiday":p[y],k.push('<div class="row date '+E+'"  style="width: '+e.getCellSize()*q+'px;">  <div class="fn-label">'+
w.getDate()+"</div></div>"),x.push('<div class="row day '+E+'"  style="width: '+e.getCellSize()*q+'px;">  <div class="fn-label">'+f.dow[y]+"</div></div>"),w=m,q=0);q++;A.push('<div class="row day '+z+'" id="dh-'+m.getTime()+'"  offset="'+u*e.getCellSize()+'"  repdate="'+m.getRepDate()+'"><div class="fn-label">'+m.getHours()+"</div></div>")}r.push('<div class="row header year" style="width: '+e.getCellSize()*n+'px;"><div class="fn-label">'+t+"</div></div>");l.push('<div class="row header month" style="width: '+
e.getCellSize()*h+'px"><div class="fn-label">'+f.months[v]+"</div></div>");z=p[w.getDay()];-1<F.indexOf((new Date(w.getFullYear(),w.getMonth(),w.getDate())).getTime())&&(z="holiday");k.push('<div class="row date '+z+'"  style="width: '+e.getCellSize()*q+'px;">  <div class="fn-label">'+w.getDate()+"</div></div>");x.push('<div class="row day '+z+'"  style="width: '+e.getCellSize()*q+'px;">  <div class="fn-label">'+f.dow[w.getDay()]+"</div></div>");c=g.dataPanel(a,c.length*e.getCellSize());c.append(r.join(""));
c.append(l.join(""));c.append(d('<div class="row"/>').html(k.join("")));c.append(d('<div class="row"/>').html(x.join("")));c.append(d('<div class="row"/>').html(A.join("")));break;case "weeks":c=e.parseWeeksRange(a.dateStart,a.dateEnd);r=['<div class="row"/>'];l=['<div class="row"/>'];t=c[0].getFullYear();v=c[0].getMonth();u=0;for(D=c.length;u<D;u++)m=c[u],m.getFullYear()!==t&&(r.push('<div class="row header year" style="width: '+e.getCellSize()*n+'px;"><div class="fn-label">'+t+"</div></div>"),t=
m.getFullYear(),n=0),n++,m.getMonth()!==v&&(l.push('<div class="row header month" style="width:'+e.getCellSize()*h+'px;"><div class="fn-label">'+f.months[v]+"</div></div>"),v=m.getMonth(),h=0),h++,k.push('<div class="row day wd"  id="'+m.getWeekId()+'" offset="'+u*e.getCellSize()+'" repdate="'+m.getRepDate()+'">  <div class="fn-label">'+m.getWeekOfYear()+"</div></div>");r.push('<div class="row header year" style="width: '+e.getCellSize()*n+'px;"><div class="fn-label">'+t+"</div></div>");l.push('<div class="row header month" style="width: '+
e.getCellSize()*h+'px"><div class="fn-label">'+f.months[v]+"</div></div>");c=g.dataPanel(a,c.length*e.getCellSize());c.append(r.join("")+l.join("")+k.join("")+x.join(""));break;case "months":c=e.parseMonthsRange(a.dateStart,a.dateEnd);t=c[0].getFullYear();v=c[0].getMonth();u=0;for(D=c.length;u<D;u++)m=c[u],m.getFullYear()!==t&&(r.push('<div class="row header year" style="width: '+e.getCellSize()*n+'px;"><div class="fn-label">'+t+"</div></div>"),t=m.getFullYear(),n=0),n++,l.push('<div class="row day wd" id="dh-'+
e.genId(m.getTime())+'" offset="'+u*e.getCellSize()+'" repdate="'+m.getRepDate()+'">'+(1+m.getMonth())+"</div>");r.push('<div class="row header year" style="width: '+e.getCellSize()*n+'px;"><div class="fn-label">'+t+"</div></div>");l.push('<div class="row header month" style="width: '+e.getCellSize()*h+'px"><div class="fn-label">'+f.months[v]+"</div></div>");c=g.dataPanel(a,c.length*e.getCellSize());c.append(r.join(""));c.append(l.join(""));c.append(d('<div class="row"/>').html(k.join("")));c.append(d('<div class="row"/>').html(x.join("")));
break;default:c=e.parseDateRange(a.dateStart,a.dateEnd);A=H(c[0],-1);t=A.getFullYear();v=A.getMonth();u=0;for(D=c.length;u<D;u++)m=c[u],m.getFullYear()!==t&&(r.push('<div class="row header year" style="width:'+e.getCellSize()*n+'px;"><div class="fn-label">'+t+"</div></div>"),t=m.getFullYear(),n=0),n++,m.getMonth()!==v&&(l.push('<div class="row header month" style="width:'+e.getCellSize()*h+'px;"><div class="fn-label">'+f.months[v]+"</div></div>"),v=m.getMonth(),h=0),h++,y=m.getDay(),z=p[y],-1<F.indexOf((new Date(m.getFullYear(),
m.getMonth(),m.getDate())).getTime())&&(z="holiday"),k.push('<div class="row date '+z+'"  id="dh-'+e.genId(m.getTime())+'" offset="'+u*e.getCellSize()+'" repdate="'+m.getRepDate()+'">  <div class="fn-label">'+m.getDate()+"</div></div>"),x.push('<div class="row day '+z+'"  id="dw-'+e.genId(m.getTime())+'"  repdate="'+m.getRepDate()+'">  <div class="fn-label">'+f.dow[y]+"</div></div>");r.push('<div class="row header year" style="width: '+e.getCellSize()*n+'px;"><div class="fn-label">'+t+"</div></div>");
l.push('<div class="row header month" style="width: '+e.getCellSize()*h+'px"><div class="fn-label">'+f.months[v]+"</div></div>");c=g.dataPanel(a,c.length*e.getCellSize());c.append(r.join(""));c.append(l.join(""));c.append(d('<div class="row" style="margin-left: 0;" />').html(k.join("")));c.append(d('<div class="row" style="margin-left: 0;" />').html(x.join("")))}return d('<div class="rightPanel"></div>').append(c)},navigation:function(a){var b=null;"scroll"===f.navigate?(b=d('<div class="navigate" />').append(d('<div class="nav-slider" />').append(d('<div class="nav-slider-left" />').append(d('<button type="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){g.navigatePage(a,
-1)})).append(d('<div class="page-number"/>').append(d("<span/>").html(a.pageNum+1+" / "+a.pageCount))).append(d('<button type="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){g.navigatePage(a,1)})).append(d('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){g.navigateTo(a,"now")})).append(d('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){"hours"===f.scale?g.navigateTo(a,8*e.getCellSize()):"days"===
f.scale?g.navigateTo(a,30*e.getCellSize()):"weeks"===f.scale?g.navigateTo(a,12*e.getCellSize()):"months"===f.scale&&g.navigateTo(a,6*e.getCellSize())})).append(d('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){"hours"===f.scale?g.navigateTo(a,4*e.getCellSize()):"days"===f.scale?g.navigateTo(a,7*e.getCellSize()):"weeks"===f.scale?g.navigateTo(a,4*e.getCellSize()):"months"===f.scale&&g.navigateTo(a,3*e.getCellSize())}))).append(d('<div class="nav-slider-content" />').append(d('<div class="nav-slider-bar" />').append(d('<a class="nav-slider-button" />')).mousedown(function(b){b.preventDefault();
a.scrollNavigation.scrollerMouseDown=!0;g.sliderScroll(a,b)}).mousemove(function(b){a.scrollNavigation.scrollerMouseDown&&g.sliderScroll(a,b)}))).append(d('<div class="nav-slider-right" />').append(d('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){"hours"===f.scale?g.navigateTo(a,-4*e.getCellSize()):"days"===f.scale?g.navigateTo(a,-7*e.getCellSize()):"weeks"===f.scale?g.navigateTo(a,-4*e.getCellSize()):"months"===f.scale&&g.navigateTo(a,-3*e.getCellSize())})).append(d('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){"hours"===
f.scale?g.navigateTo(a,-8*e.getCellSize()):"days"===f.scale?g.navigateTo(a,-30*e.getCellSize()):"weeks"===f.scale?g.navigateTo(a,-12*e.getCellSize()):"months"===f.scale&&g.navigateTo(a,-6*e.getCellSize())})).append(d('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){g.zoomInOut(a,-1)})).append(d('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){g.zoomInOut(a,1)})))),d(document).mouseup(function(){a.scrollNavigation.scrollerMouseDown=
!1})):b=d('<div class="navigate" />').append(d('<button type="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){g.navigatePage(a,-1)})).append(d('<div class="page-number"/>').append(d("<span/>").html(a.pageNum+1+" of "+a.pageCount))).append(d('<button type="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){g.navigatePage(a,1)})).append(d('<button type="button" class="nav-link nav-begin"/>').html("&#124;&lt;").click(function(){g.navigateTo(a,"begin")})).append(d('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){g.navigateTo(a,
7*e.getCellSize())})).append(d('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){g.navigateTo(a,e.getCellSize())})).append(d('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){g.navigateTo(a,"now")})).append(d('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){g.navigateTo(a,-1*e.getCellSize())})).append(d('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){g.navigateTo(a,
-7*e.getCellSize())})).append(d('<button type="button" class="nav-link nav-end"/>').html("&gt;&#124;").click(function(){g.navigateTo(a,"end")})).append(d('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){g.zoomInOut(a,-1)})).append(d('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){g.zoomInOut(a,1)}));return d('<div class="bottom"/>').append(b)},createProgressBar:function(a){var b="dl"in a?a.dl:"",c="customClass"in a?a.customClass:
"",p="desc"in a?a.desc:"",g="label"in a?a.label:"";a="dataObj"in a?a.dataObj:null;var n=e.getCellSize(),l=e.getProgressBarMargin()||0,b=d('<div class="bar"><div class="fn-label">'+g+"</div></div>").addClass(c).css({width:n*b-l+2}).data(a);p&&b.mouseover(function(a){var b=d('<div class="fn-gantt-hint" />').html(p);d("body").append(b);b.css("left",a.pageX);b.css("top",a.pageY);b.show()}).mouseout(function(){d(".fn-gantt-hint").remove()}).mousemove(function(a){d(".fn-gantt-hint").css("left",a.pageX);
d(".fn-gantt-hint").css("top",a.pageY+15)});b.click(function(a){a.stopPropagation();f.onItemClick(d(this).data("dataObj"))});return b},markNow:function(a){switch(f.scale){case "weeks":var b=Date.parse(new Date),b=364E5*Math.floor(b/364E5);d(a).find(':findweek("'+b+'")').removeClass("wd").addClass("today");break;case "months":d(a).find(':findmonth("'+(new Date).getTime()+'")').removeClass("wd").addClass("today");break;default:b=Date.parse(new Date),b=364E5*Math.floor(b/364E5),d(a).find(':findday("'+
b+'")').removeClass("wd").addClass("today")}},fillData:function(a,b,c){d.each(a.data,function(c,r){c>=a.pageNum*f.itemsPerPage&&c<a.pageNum*f.itemsPerPage+f.itemsPerPage&&d.each(r.values,function(r,l){var h=null;switch(f.scale){case "hours":var h=e.genId(e.dateDeserialize(l.from).getTime(),a.scaleStep),k=d(a).find("#dh-"+h),q=e.genId(e.dateDeserialize(l.to).getTime(),a.scaleStep),x=d(a).find("#dh-"+q);console.log(h,q);k=k.attr("offset");h=x.attr("offset");h=Math.floor((h-k)/e.getCellSize())+1;l.dl=
h;h=g.createProgressBar(l);q=d(a).find("#rowheader"+c);q=5*e.getCellSize()+2+parseInt(q.attr("offset"),10);h.css({top:q,left:Math.floor(k)});b.append(h);break;case "weeks":k=e.dateDeserialize(l.from);h=e.dateDeserialize(l.to);3>=k.getDate()&&0===k.getMonth()&&k.setDate(k.getDate()+4);3>=k.getDate()&&0===k.getMonth()&&k.setDate(k.getDate()+4);3>=h.getDate()&&0===h.getMonth()&&h.setDate(h.getDate()+4);k=d(a).find("#"+k.getWeekId());k=k.attr("offset");x=d(a).find("#"+h.getWeekId());h=x.attr("offset");
h=Math.round((h-k)/e.getCellSize())+1;l.dl=h;h=g.createProgressBar(l);q=d(a).find("#rowheader"+c);q=3*e.getCellSize()+2+parseInt(q.attr("offset"),10);h.css({top:q,left:Math.floor(k)});b.append(h);break;case "months":k=e.dateDeserialize(l.from);h=e.dateDeserialize(l.to);3>=k.getDate()&&0===k.getMonth()&&k.setDate(k.getDate()+4);3>=k.getDate()&&0===k.getMonth()&&k.setDate(k.getDate()+4);3>=h.getDate()&&0===h.getMonth()&&h.setDate(h.getDate()+4);k=d(a).find("#dh-"+e.genId(k.getTime()));k=k.attr("offset");
x=d(a).find("#dh-"+e.genId(h.getTime()));h=x.attr("offset");h=Math.round((h-k)/e.getCellSize())+1;l.dl=h;h=g.createProgressBar(l);q=d(a).find("#rowheader"+c);q=2*e.getCellSize()+2+parseInt(q.attr("offset"),10);h.css({top:q,left:Math.floor(k)});b.append(h);break;default:h=e.genId(e.dateDeserialize(l.from).getTime()),q=e.genId(e.dateDeserialize(l.to).getTime()),k=d(a).find("#dh-"+h),k=k.attr("offset"),h=Math.floor((q/1E3-h/1E3)/86400)+1,l.dl=h,h=g.createProgressBar(l),q=d(a).find("#rowheader"+c),q=
4*e.getCellSize()+2+parseInt(q.attr("offset"),10),h.css({top:q,left:Math.floor(k)}),b.append(h)}if((k=h.find(".fn-label"))&&h.length){var A;h=h[0].style.backgroundColor;try{var h=h.replace("rgb(","").replace(")",""),B=h.split(","),C=parseInt(B[0],10),t=parseInt(B[1],10),v=parseInt(B[2],10),w=Math.round(.9*(255-(.299*C+.587*t+.114*v)));A="rgb("+w+", "+w+", "+w+")"}catch(u){A=""}k.css("color",A)}else k&&k.css("color","")})})},navigateTo:function(a,b){var c=d(a).find(".fn-gantt .rightPanel"),e=c.find(".dataPanel");
e.click=function(){alert(arguments.join(""))};var c=c.width(),f=e.width();switch(b){case "begin":e.animate({"margin-left":"0px"},"fast",function(){g.repositionLabel(a)});a.scrollNavigation.panelMargin=0;break;case "end":c=f-c;a.scrollNavigation.panelMargin=-1*c;e.animate({"margin-left":"-"+c+"px"},"fast",function(){g.repositionLabel(a)});break;case "now":if(!a.scrollNavigation.canScroll||!e.find(".today").length)return!1;c=-1*(f-c);f=e.css("margin-left").replace("px","");b=e.find(".today").offset().left-
e.offset().left;b*=-1;0<b?b=0:b<c&&(b=c);e.animate({"margin-left":b+"px"},"fast",g.repositionLabel(a));a.scrollNavigation.panelMargin=b;break;default:c=-1*(f-c),f=e.css("margin-left").replace("px",""),b=parseInt(f,10)+b,0>=b&&b>=c&&e.animate({"margin-left":b+"px"},"fast",g.repositionLabel(a)),a.scrollNavigation.panelMargin=b}g.synchronizeScroller(a)},navigatePage:function(a,b){0<=a.pageNum+b&&a.pageNum+b<Math.ceil(a.rowsNum/f.itemsPerPage)&&g.waitToggle(a,!0,function(){a.pageNum+=b;a.hPosition=d(".fn-gantt .dataPanel").css("margin-left").replace("px",
"");a.scaleOldWidth=!1;g.init(a)})},zoomInOut:function(a,b){g.waitToggle(a,!0,function(){var c=0>b,e=a.scaleStep+3*b,e=1>=e?1:4===e?3:e,r=f.scale,n=a.headerRows;"hours"===f.scale&&13<=e?(r="days",n=4,e=13):"days"===f.scale&&c?(r="hours",n=5,e=12):"days"!==f.scale||c?"weeks"!==f.scale||c?"weeks"===f.scale&&c?(r="days",n=4,e=13):"months"===f.scale&&c&&(r="weeks",n=3,e=13):(r="months",n=2,e=14):(r="weeks",n=3,e=13);c&&d.inArray(r,C)<d.inArray(f.minScale,C)||!c&&d.inArray(r,C)>d.inArray(f.maxScale,C)||
(a.scaleStep=e,f.scale=r,a.headerRows=n,c=d(a).find(".fn-gantt .rightPanel"),e=c.find(".dataPanel"),a.hPosition=e.css("margin-left").replace("px",""),a.scaleOldWidth=e.width()-c.width(),f.useCookie&&(d.cookie(this.cookieKey+"CurrentScale",f.scale),d.cookie(this.cookieKey+"ScrollPos",null)));g.init(a)})},mouseScroll:function(a,b){var c=d(a).find(".fn-gantt .dataPanel");c.css("cursor","move");c.offset();c=b.pageX-(null===a.scrollNavigation.mouseX?b.pageX:a.scrollNavigation.mouseX);a.scrollNavigation.mouseX=
b.pageX;g.scrollPanel(a,c);clearTimeout(a.scrollNavigation.repositionDelay);a.scrollNavigation.repositionDelay=setTimeout(g.repositionLabel,50,a)},wheelScroll:function(a,b){b.preventDefault();g.scrollPanel(a,b.detail?-50*b.detail:b.wheelDelta/120*50);clearTimeout(a.scrollNavigation.repositionDelay);a.scrollNavigation.repositionDelay=setTimeout(g.repositionLabel,50,a)},sliderScroll:function(a,b){var c=d(a).find(".nav-slider-bar"),e=c.find(".nav-slider-button"),f=d(a).find(".fn-gantt .rightPanel"),
n=f.find(".dataPanel"),l=c.offset(),c=c.width(),h=e.width();b.pageX>=l.left&&b.pageX<=l.left+c&&(l=b.pageX-l.left,l-=h/2,e.css("left",l),e=n.width()-f.width(),f=l*e/c*-1,0<=f?(n.css("margin-left","0px"),a.scrollNavigation.panelMargin=0):l>=c-1*h?(n.css("margin-left",-1*e+"px"),a.scrollNavigation.panelMargin=-1*e):(n.css("margin-left",f+"px"),a.scrollNavigation.panelMargin=f),clearTimeout(a.scrollNavigation.repositionDelay),a.scrollNavigation.repositionDelay=setTimeout(g.repositionLabel,5,a))},scrollPanel:function(a,
b){if(!a.scrollNavigation.canScroll)return!1;var c=parseInt(a.scrollNavigation.panelMargin,10)+b;a.scrollNavigation.panelMargin=0<c?0:c<-1*a.scrollNavigation.panelMaxPos?-1*a.scrollNavigation.panelMaxPos:c;d(a).find(".fn-gantt .dataPanel").css("margin-left",a.scrollNavigation.panelMargin+"px");g.synchronizeScroller(a)},synchronizeScroller:function(a){if("scroll"===f.navigate){var b=d(a).find(".fn-gantt .rightPanel"),c=b.find(".dataPanel"),e=d(a).find(".nav-slider-bar");a=e.find(".nav-slider-button");
var e=e.width(),g=a.width(),b=c.width()-b.width(),n=0;c.css("margin-left")&&(n=c.css("margin-left").replace("px",""));c=n*e/b-.25*a.width();a.css("left",-1*(0<c?0:-1*c>=e-.75*g?-1*(e-1.25*g):c))}},repositionLabel:function(a){setTimeout(function(){var b;b=a?d(a).find(".fn-gantt .rightPanel").find(".dataPanel"):d(".fn-gantt .rightPanel .dataPanel");f.useCookie&&d.cookie(this.cookieKey+"ScrollPos",b.css("margin-left").replace("px",""))},500)},waitToggle:function(a,b,c){b?(d(a).offset(),d(a).outerWidth(),
d(a).outerHeight(),a.loader||(a.loader=d('<div class="fn-gantt-loader"><div class="fn-gantt-loader-spinner"><span>'+f.waitText+"</span></div></div>")),d(a).append(a.loader),setTimeout(c,500)):a.loader&&a.loader.detach()}},e={getMaxDate:function(a){var b=null;d.each(a.data,function(a,c){d.each(c.values,function(a,c){b=b<e.dateDeserialize(c.to)?e.dateDeserialize(c.to):b})});b=b||new Date;switch(f.scale){case "hours":b.setHours(Math.ceil(b.getHours()/a.scaleStep)*a.scaleStep);b.setHours(b.getHours()+
3*a.scaleStep);break;case "weeks":a=new Date(b.getTime());a=new Date(a.setDate(a.getDate()+21));var c=7*Math.floor(a.getDate()/7),b=new Date(a.getFullYear(),a.getMonth(),0===c?4:c-3);break;case "months":a=new Date(b.getFullYear(),b.getMonth(),1);a.setMonth(a.getMonth()+2);b=new Date(a.getFullYear(),a.getMonth(),1);break;default:b.setHours(0),b.setDate(b.getDate()+3)}return b},getMinDate:function(a){var b=null;d.each(a.data,function(a,c){d.each(c.values,function(a,c){b=b>e.dateDeserialize(c.from)||
null===b?e.dateDeserialize(c.from):b})});b=b||new Date;switch(f.scale){case "hours":b.setHours(Math.floor(b.getHours()/a.scaleStep)*a.scaleStep);b.setHours(b.getHours()-3*a.scaleStep);break;case "weeks":a=new Date(b.getTime());a=new Date(a.setDate(a.getDate()-21));var c=7*Math.floor(a.getDate()/7),b=new Date(a.getFullYear(),a.getMonth(),0===c?4:c-3);break;case "months":a=new Date(b.getFullYear(),b.getMonth(),1);a.setMonth(a.getMonth()-3);b=new Date(a.getFullYear(),a.getMonth(),1);break;default:b.setHours(0),
b.setDate(b.getDate()-3)}return b},parseDateRange:function(a,b){var c=new Date(a.getTime());b.getTime();var d=[],e=0;do d[e++]=new Date(c.getTime()),c.setDate(c.getDate()+1);while(c.getTime()<=b.getTime());return d},parseTimeRange:function(a,b,c){a=new Date(a);var d=new Date(b);a.setMilliseconds(0);a.setSeconds(0);a.setMinutes(0);a.setHours(0);d.setMilliseconds(0);d.setSeconds(0);if(0<d.getMinutes()||0<d.getHours())d.setMinutes(0),d.setHours(0),d.setTime(d.getTime()+864E5);for(var d=[],e=0;;){var f=
new Date(a);f.setHours(Math.floor(a.getHours()/c)*c);d[e]&&f.getDay()!==d[e].getDay()&&f.setHours(0);d[e]=f;if(a.getTime()>b.getTime())break;a=H(f,c);e++}return d},parseWeeksRange:function(a,b){var c=new Date(a),d=[],e=0;do 0===c.getDay()&&(d[e++]=c.getDayForWeek()),c.setDate(c.getDate()+1);while(c.getTime()<=b.getTime());return d},parseMonthsRange:function(a,b){var c=new Date(a),d=[],e=0;do d[e++]=new Date(c.getFullYear(),c.getMonth(),1),c.setMonth(c.getMonth()+1);while(c.getTime()<=b.getTime());
return d},dateDeserialize:function(a){"string"===typeof a&&(a=a.replace(/\/Date\((.*)\)\//,"$1"),a=d.isNumeric(a)?parseInt(a,10):d.trim(a));return new Date(a)},genId:function(a){var b=new Date(a);switch(f.scale){case "hours":var c=b.getHours();2<=arguments.length&&(c=Math.floor(b.getHours()/arguments[1])*arguments[1]);return(new Date(b.getFullYear(),b.getMonth(),b.getDate(),c)).getTime();case "weeks":var c=b.getFullYear(),d=b.getDayForWeek().getWeekOfYear();11===b.getMonth()&&1===d&&c++;return c+
"-"+d;case "months":return b.getFullYear()+"-"+b.getMonth();default:return(new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()}},_datesToDays:function(a){for(var b={},c=0,d=a.length,f;c<d;c++)f=e.dateDeserialize(a[c]),b[f.setHours(0,0,0,0)]=!0;return b},isHoliday:function(){if(!f.holidays)return function(){return!1};var a=!1;return function(b){a||(a=e._datesToDays(f.holidays));return!!a[d.isNumeric(b)?b:(new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()]}}(),_getCellSize:null,
getCellSize:function(){e._getCellSize||(d("body").append(d('<div style="display: none; position: absolute;" class="fn-gantt" id="measureCellWidth"><div class="row"></div></div>')),e._getCellSize=d("#measureCellWidth .row").height(),d("#measureCellWidth").empty().remove());return e._getCellSize},getRightPanelSize:function(){d("body").append(d('<div style="display: none; position: absolute;" class="fn-gantt" id="measureCellWidth"><div class="rightPanel"></div></div>'));var a=d("#measureCellWidth .rightPanel").height();
d("#measureCellWidth").empty().remove();return a},getPageHeight:function(a){return a.pageNum+1===a.pageCount?a.rowsOnLastPage*e.getCellSize():f.itemsPerPage*e.getCellSize()},_getProgressBarMargin:null,getProgressBarMargin:function(){e._getProgressBarMargin||0===e._getProgressBarMargin||(d("body").append(d('<div style="display: none; position: absolute;" id="measureBarWidth" ><div class="fn-gantt"><div class="rightPanel"><div class="dataPanel"><div class="row day"><div class="bar" /></div></div></div></div></div>')),
e._getProgressBarMargin=parseInt(d("#measureBarWidth .fn-gantt .rightPanel .day .bar").css("margin-left").replace("px",""),10),e._getProgressBarMargin+=parseInt(d("#measureBarWidth .fn-gantt .rightPanel .day .bar").css("margin-right").replace("px",""),10),d("#measureBarWidth").empty().remove());return e._getProgressBarMargin}};this.each(function(){this.data=null;this.hPosition=this.rowsNum=this.rowsOnLastPage=this.pageCount=this.pageNum=0;this.dateEnd=this.dateStart=null;this.scrollClicked=!1;this.headerRows=
this.scaleOldWidth=null;f.useCookie&&(d.cookie(this.cookieKey+"CurrentScale")?f.scale=d.cookie(this.cookieKey+"CurrentScale"):d.cookie(this.cookieKey+"CurrentScale",f.scale));switch(f.scale){case "hours":this.headerRows=5;this.scaleStep=1;break;case "weeks":this.headerRows=3;this.scaleStep=13;break;case "months":this.headerRows=2;this.scaleStep=14;break;default:this.headerRows=4,this.scaleStep=13}this.scrollNavigation={panelMouseDown:!1,scrollerMouseDown:!1,mouseX:null,panelMargin:0,repositionDelay:0,
panelMaxPos:0,canScroll:!0};this.loader=this.gantt=null;g.create(this)})}})(jQuery);