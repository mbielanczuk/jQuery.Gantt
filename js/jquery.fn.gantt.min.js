(function(a){a.fn.gantt=function(d){var h="jquery.fn.gantt";var g=["hours","days","weeks","months"];var e={source:[],itemsPerPage:7,multiTaskPerRow:false,categoryAmount:0,rowsPerPage:0,months:["January","February","March","April","May","June","July","August","September","October","November","December"],dow:["S","M","T","W","T","F","S"],startPos:new Date(),navigate:"buttons",scale:"days",useCookie:false,maxScale:"months",minScale:"hours",waitText:"Please wait...",onItemClick:function(i){return;
},onAddClick:function(i){return;},onRender:function(){return;},onDataLoadFailed:function(i){return;},scrollToToday:true};if(d){a.extend(e,d);}e.useCookie=e.useCookie&&a.isFunction(a.cookie);
a.extend(a.expr[":"],{findday:function(k,o,j){var p=new Date(parseInt(j[3],10));var q=a(k).attr("id");q=q?q:"";var n=q.indexOf("-")+1;var l=new Date(parseInt(q.substring(n,q.length),10));
p=new Date(p.getFullYear(),p.getMonth(),p.getDate());l=new Date(l.getFullYear(),l.getMonth(),l.getDate());return p.getTime()===l.getTime();}});a.extend(a.expr[":"],{findweek:function(k,o,j){var p=new Date(parseInt(j[3],10));
var q=a(k).attr("id");q=q?q:"";var n=q.indexOf("-")+1;p=p.getFullYear()+"-"+p.getDayForWeek().getWeekOfYear();var l=q.substring(n,q.length);return p===l;
}});a.extend(a.expr[":"],{findmonth:function(k,o,j){var p=new Date(parseInt(j[3],10));p=p.getFullYear()+"-"+p.getMonth();var q=a(k).attr("id");q=q?q:"";
var n=q.indexOf("-")+1;var l=q.substring(n,q.length);return p===l;}});Date.prototype.getWeekId=function(){var k=this.getFullYear();var j=this.getDayForWeek().getWeekOfYear();
var i=this.getMonth();if(i===11&&j===1){k++;}return"dh-"+k+"-"+j;};Date.prototype.getRepDate=function(){switch(e.scale){case"hours":return this.getTime();
case"weeks":return this.getDayForWeek().getTime();case"months":return new Date(this.getFullYear(),this.getMonth(),1).getTime();default:return this.getTime();
}};Date.prototype.getDayOfYear=function(){var i=new Date(this.getFullYear(),0,0);var j=new Date(this.getFullYear(),this.getMonth(),this.getDate());return Math.ceil((j-i)/86400000);
};Date.prototype.getWeekOfYear=function(){var i=new Date(this.getFullYear(),0,1);var j=new Date(this.getTime());j.setDate(j.getDate()+4-(j.getDay()||7));
return Math.floor(Math.round((j-i)/86400000)/7)+1;};Date.prototype.getDaysInMonth=function(){return 32-new Date(this.getFullYear(),this.getMonth(),32).getDate();
};Date.prototype.hasWeek=function(){var j=new Date(this.valueOf());j.setDate(j.getDate()-j.getDay());var i=new Date(this.valueOf());i.setDate(i.getDate()+(6-i.getDay()));
if(j.getMonth()===i.getMonth()){return true;}else{return(j.getMonth()===this.getMonth()&&i.getDate()<4)||(j.getMonth()!==this.getMonth()&&i.getDate()>=4);
}};Date.prototype.getDayForWeek=function(){var j=new Date(this.valueOf());j.setDate(j.getDate()-j.getDay());var i=new Date(this.valueOf());i.setDate(i.getDate()+(6-i.getDay()));
if((j.getMonth()===i.getMonth())||(j.getMonth()!==i.getMonth()&&i.getDate()>=4)){return new Date(i.setDate(i.getDate()-3));}else{return new Date(j.setDate(j.getDate()+3));
}};function b(j,k){for(var i=1;;i++){var l=new Date(j);l.setHours(j.getHours()+k*i);if(l.getTime()!==j.getTime()){return l;}}}var c={elementFromPoint:function(i,j){if(!a.support.boxModel){i-=a(document).scrollLeft();
j-=a(document).scrollTop();}else{i-=window.pageXOffset;j-=window.pageYOffset;}return document.elementFromPoint(i,j);},create:function(i){if(typeof e.source!=="string"){i.data=e.source;
c.init(i);}else{a.getJSON(e.source,function(j){i.data=j;c.init(i);});}},init:function(i){try{i.rowsNum=i.data.length;switch(e.multiTaskPerRow){case true:i.pageCount=Math.ceil(e.categoryAmount/e.rowsPerPage);
break;default:i.pageCount=Math.ceil(i.rowsNum/e.itemsPerPage);i.rowsOnLastPage=i.rowsNum-(Math.floor(i.rowsNum/e.itemsPerPage)*e.itemsPerPage);break;}i.dateStart=f.getMinDate(i);
i.dateEnd=f.getMaxDate(i);c.waitToggle(i,true,function(){c.render(i);});}catch(j){if(i.data===null||(typeof i.data==="object"&&i.data.length===0)){e.onDataLoadFailed(a(this).data("dataObj"));
}}},render:function(l){var m=a('<div class="fn-content"/>');var i=c.leftPanel(l);m.append(i);var k=c.rightPanel(l,i);var p,j;m.append(k);m.append(c.navigation(l));
var o=k.find(".dataPanel");l.gantt=a('<div class="fn-gantt" />').append(m);a(l).html(l.gantt);l.scrollNavigation.panelMargin=parseInt(o.css("margin-left").replace("px",""),10);
l.scrollNavigation.panelMaxPos=(o.width()-k.width());l.scrollNavigation.canScroll=(o.width()>k.width());c.markNow(l);c.fillData(l,o,i);if(e.useCookie){var n=a.cookie(this.cookieKey+"ScrollPos");
if(n){l.hPosition=n;}}if(e.scrollToToday){c.navigateTo(l,"now");c.scrollPanel(l,0);}else{if(l.hPosition!==0){if(l.scaleOldWidth){p=(o.width()-k.width());
j=p*l.hPosition/l.scaleOldWidth;j=j>0?0:j;o.css({"margin-left":j+"px"});l.scrollNavigation.panelMargin=j;l.hPosition=j;l.scaleOldWidth=null;}else{o.css({"margin-left":l.hPosition+"px"});
l.scrollNavigation.panelMargin=l.hPosition;}c.repositionLabel(l);}}o.css({height:i.height()});c.waitToggle(l,false);e.onRender();},leftPanel:function(k){var j=a('<div class="leftPanel"/>').append(a('<div class="row spacer"/>').css("height",f.getCellSize()*k.headerRows+"px").css("width","100%"));
var i=[];a.each(k.data,function(l,m){switch(e.multiTaskPerRow){case true:if(m.values[0].cat<=((k.pageNum+1)*e.rowsPerPage-1)&&(m.values[0].cat>(k.pageNum*e.rowsPerPage-1))){if(m.name){i.push('<div class="row name row'+l+(m.desc?"":" fn-wide")+'" id="rowheader'+l+'" offset="'+m.values[0].cat%e.rowsPerPage*f.getCellSize()+'">');
i.push('<span class="fn-label'+(m.cssClass?" "+m.cssClass:"")+'">'+(m.name||"")+"</span>");i.push("</div>");}if(m.desc){i.push('<div class="row desc row'+l+' " id="RowdId_'+l+'" data-id="'+m.id+'">');
i.push('<span class="fn-label'+(m.cssClass?" "+m.cssClass:"")+'">'+m.desc+"</span>");i.push("</div>");}}break;default:if(l>=k.pageNum*e.itemsPerPage&&l<(k.pageNum*e.itemsPerPage+e.itemsPerPage)){i.push('<div class="row name row'+l+(m.desc?"":" fn-wide")+'" id="rowheader'+l+'" offset="'+l%e.itemsPerPage*f.getCellSize()+'">');
i.push('<span class="fn-label'+(m.cssClass?" "+m.cssClass:"")+'">'+(m.name||"")+"</span>");i.push("</div>");if(m.desc){i.push('<div class="row desc row'+l+' " id="RowdId_'+l+'" data-id="'+m.id+'">');
i.push('<span class="fn-label'+(m.cssClass?" "+m.cssClass:"")+'">'+m.desc+"</span>");i.push("</div>");}}}});j.append(i.join(""));return j;},dataPanel:function(k,l){var i=a('<div class="dataPanel" style="width: '+l+'px;"/>');
var j=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";if(document.attachEvent){k.attachEvent("on"+j,function(m){c.wheelScroll(k,m);
});}else{if(document.addEventListener){k.addEventListener(j,function(m){c.wheelScroll(k,m);},false);}}i.click(function(r){r.stopPropagation();var t,s;var p=a(k).find(".fn-gantt .leftPanel");
var q=a(k).find(".fn-gantt .dataPanel");switch(e.scale){case"weeks":s=f.getCellSize()*2;break;case"months":s=f.getCellSize();break;case"hours":s=f.getCellSize()*4;
break;case"days":s=f.getCellSize()*3;break;default:s=f.getCellSize()*2;break;}var n=c.elementFromPoint(r.pageX,q.offset().top+s);if(n.className==="fn-label"){n=a(n.parentNode);
}else{n=a(n);}var m=n.attr("repdate");var u=c.elementFromPoint(p.offset().left+p.width()-10,r.pageY);if(u.className.indexOf("fn-label")===0){u=a(u.parentNode);
}else{u=a(u);}var o=u.data().id;e.onAddClick(m,o);});return i;},rightPanel:function(k,H){var y=null;var B=["sn","wd","wd","wd","wd","wd","sa"];var A=['<div class="row"/>'];
var L=0;var z=['<div class="row"/>'];var j=0;var u=[];var m=0;var F=[];var x=[];var J=new Date();J=new Date(J.getFullYear(),J.getMonth(),J.getDate());var l=e.holidays?e.holidays.join():"";
switch(e.scale){case"hours":y=f.parseTimeRange(k.dateStart,k.dateEnd,k.scaleStep);var w=y[0].getFullYear();var K=y[0].getMonth();var E=y[0];for(var D=0,G=y.length;
D<G;D++){var C=y[D];var p=C.getFullYear();if(p!==w){A.push(('<div class="row header year" style="width: '+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>"));
w=p;L=0;}L++;var v=C.getMonth();if(v!==K){z.push(('<div class="row header month" style="width: '+f.getCellSize()*j+'px"><div class="fn-label">'+e.months[K]+"</div></div>"));
K=v;j=0;}j++;var s=C.getDay();var q=E.getDay();var r=B[s];var I=E.getTime();if(l.indexOf((new Date(C.getFullYear(),C.getMonth(),C.getDate())).getTime())>-1){r="holiday";
}if(s!==q){var o=(J-E===0)?" today":(l.indexOf(I)>-1)?"holiday":B[q];u.push('<div class="row date '+o+'"  style="width: '+f.getCellSize()*m+'px;">  <div class="fn-label">'+E.getDate()+"</div></div>");
F.push('<div class="row day '+o+'"  style="width: '+f.getCellSize()*m+'px;">  <div class="fn-label">'+e.dow[q]+"</div></div>");E=C;m=0;}m++;x.push('<div class="row day '+r+'" id="dh-'+C.getTime()+'"  offset="'+D*f.getCellSize()+'"  repdate="'+C.getRepDate()+'"><div class="fn-label">'+C.getHours()+"</div></div>");
}A.push('<div class="row header year" style="width: '+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>");z.push('<div class="row header month" style="width: '+f.getCellSize()*j+'px"><div class="fn-label">'+e.months[K]+"</div></div>");
var r=B[E.getDay()];if(l.indexOf((new Date(E.getFullYear(),E.getMonth(),E.getDate())).getTime())>-1){r="holiday";}u.push('<div class="row date '+r+'"  style="width: '+f.getCellSize()*m+'px;">  <div class="fn-label">'+E.getDate()+"</div></div>");
F.push('<div class="row day '+r+'"  style="width: '+f.getCellSize()*m+'px;">  <div class="fn-label">'+e.dow[E.getDay()]+"</div></div>");var n=c.dataPanel(k,y.length*f.getCellSize());
n.append(A.join(""));n.append(z.join(""));n.append(a('<div class="row"/>').html(u.join("")));n.append(a('<div class="row"/>').html(F.join("")));n.append(a('<div class="row"/>').html(x.join("")));
break;case"weeks":y=f.parseWeeksRange(k.dateStart,k.dateEnd);A=['<div class="row"/>'];z=['<div class="row"/>'];var w=y[0].getFullYear();var K=y[0].getMonth();
var E=y[0];for(var D=0,G=y.length;D<G;D++){var C=y[D];if(C.getFullYear()!==w){A.push(('<div class="row header year" style="width: '+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>"));
w=C.getFullYear();L=0;}L++;if(C.getMonth()!==K){z.push(('<div class="row header month" style="width:'+f.getCellSize()*j+'px;"><div class="fn-label">'+e.months[K]+"</div></div>"));
K=C.getMonth();j=0;}j++;u.push('<div class="row day wd"  id="'+C.getWeekId()+'" offset="'+D*f.getCellSize()+'" repdate="'+C.getRepDate()+'">  <div class="fn-label">'+C.getWeekOfYear()+"</div></div>");
}A.push('<div class="row header year" style="width: '+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>");z.push('<div class="row header month" style="width: '+f.getCellSize()*j+'px"><div class="fn-label">'+e.months[K]+"</div></div>");
var n=c.dataPanel(k,y.length*f.getCellSize());n.append(A.join("")+z.join("")+u.join("")+(F.join("")));break;case"months":y=f.parseMonthsRange(k.dateStart,k.dateEnd);
var w=y[0].getFullYear();var K=y[0].getMonth();var E=y[0];for(var D=0,G=y.length;D<G;D++){var C=y[D];if(C.getFullYear()!==w){A.push(('<div class="row header year" style="width: '+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>"));
w=C.getFullYear();L=0;}L++;z.push('<div class="row day wd" id="dh-'+f.genId(C.getTime())+'" offset="'+D*f.getCellSize()+'" repdate="'+C.getRepDate()+'">'+(1+C.getMonth())+"</div>");
}A.push('<div class="row header year" style="width: '+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>");z.push('<div class="row header month" style="width: '+f.getCellSize()*j+'px"><div class="fn-label">'+e.months[K]+"</div></div>");
var n=c.dataPanel(k,y.length*f.getCellSize());n.append(A.join(""));n.append(z.join(""));n.append(a('<div class="row"/>').html(u.join("")));n.append(a('<div class="row"/>').html(F.join("")));
break;default:y=f.parseDateRange(k.dateStart,k.dateEnd);var t=b(y[0],-1);var w=t.getFullYear();var K=t.getMonth();var E=t;for(var D=0,G=y.length;D<G;D++){var C=y[D];
if(C.getFullYear()!==w){A.push(('<div class="row header year" style="width:'+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>"));w=C.getFullYear();
L=0;}L++;if(C.getMonth()!==K){z.push(('<div class="row header month" style="width:'+f.getCellSize()*j+'px;"><div class="fn-label">'+e.months[K]+"</div></div>"));
K=C.getMonth();j=0;}j++;var q=C.getDay();var r=B[q];if(l.indexOf((new Date(C.getFullYear(),C.getMonth(),C.getDate())).getTime())>-1){r="holiday";}u.push('<div class="row date '+r+'"  id="dh-'+f.genId(C.getTime())+'" offset="'+D*f.getCellSize()+'" repdate="'+C.getRepDate()+'">  <div class="fn-label">'+C.getDate()+"</div></div>");
F.push('<div class="row day '+r+'"  id="dw-'+f.genId(C.getTime())+'"  repdate="'+C.getRepDate()+'">  <div class="fn-label">'+e.dow[q]+"</div></div>");}A.push('<div class="row header year" style="width: '+f.getCellSize()*L+'px;"><div class="fn-label">'+w+"</div></div>");
z.push('<div class="row header month" style="width: '+f.getCellSize()*j+'px"><div class="fn-label">'+e.months[K]+"</div></div>");var n=c.dataPanel(k,y.length*f.getCellSize());
n.append(A.join(""));n.append(z.join(""));n.append(a('<div class="row" style="margin-left: 0;" />').html(u.join("")));n.append(a('<div class="row" style="margin-left: 0;" />').html(F.join("")));
break;}return a('<div class="rightPanel"></div>').append(n);},navigation:function(i){var j=null;if(e.navigate==="scroll"){j=a('<div class="navigate" />').append(a('<div class="nav-slider" />').append(a('<div class="nav-slider-left" />').append(a('<button type="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){c.navigatePage(i,-1);
})).append(a('<div class="page-number"/>').append(a("<span/>").html(i.pageNum+1+" / "+i.pageCount))).append(a('<button type="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){c.navigatePage(i,1);
})).append(a('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){c.navigateTo(i,"now");})).append(a('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){if(e.scale==="hours"){c.navigateTo(i,f.getCellSize()*8);
}else{if(e.scale==="days"){c.navigateTo(i,f.getCellSize()*30);}else{if(e.scale==="weeks"){c.navigateTo(i,f.getCellSize()*12);}else{if(e.scale==="months"){c.navigateTo(i,f.getCellSize()*6);
}}}}})).append(a('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){if(e.scale==="hours"){c.navigateTo(i,f.getCellSize()*4);
}else{if(e.scale==="days"){c.navigateTo(i,f.getCellSize()*7);}else{if(e.scale==="weeks"){c.navigateTo(i,f.getCellSize()*4);}else{if(e.scale==="months"){c.navigateTo(i,f.getCellSize()*3);
}}}}}))).append(a('<div class="nav-slider-content" />').append(a('<div class="nav-slider-bar" />').append(a('<a class="nav-slider-button" />')).mousedown(function(k){k.preventDefault();
i.scrollNavigation.scrollerMouseDown=true;c.sliderScroll(i,k);}).mousemove(function(k){if(i.scrollNavigation.scrollerMouseDown){c.sliderScroll(i,k);}}))).append(a('<div class="nav-slider-right" />').append(a('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){if(e.scale==="hours"){c.navigateTo(i,f.getCellSize()*-4);
}else{if(e.scale==="days"){c.navigateTo(i,f.getCellSize()*-7);}else{if(e.scale==="weeks"){c.navigateTo(i,f.getCellSize()*-4);}else{if(e.scale==="months"){c.navigateTo(i,f.getCellSize()*-3);
}}}}})).append(a('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){if(e.scale==="hours"){c.navigateTo(i,f.getCellSize()*-8);
}else{if(e.scale==="days"){c.navigateTo(i,f.getCellSize()*-30);}else{if(e.scale==="weeks"){c.navigateTo(i,f.getCellSize()*-12);}else{if(e.scale==="months"){c.navigateTo(i,f.getCellSize()*-6);
}}}}})).append(a('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){c.zoomInOut(i,-1);})).append(a('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){c.zoomInOut(i,1);
}))));a(document).mouseup(function(){i.scrollNavigation.scrollerMouseDown=false;});}else{j=a('<div class="navigate" />').append(a('<button type="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){c.navigatePage(i,-1);
})).append(a('<div class="page-number"/>').append(a("<span/>").html(i.pageNum+1+" of "+i.pageCount))).append(a('<button type="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){c.navigatePage(i,1);
})).append(a('<button type="button" class="nav-link nav-begin"/>').html("&#124;&lt;").click(function(){c.navigateTo(i,"begin");})).append(a('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){c.navigateTo(i,f.getCellSize()*7);
})).append(a('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){c.navigateTo(i,f.getCellSize());})).append(a('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){c.navigateTo(i,"now");
})).append(a('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){c.navigateTo(i,f.getCellSize()*-1);})).append(a('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){c.navigateTo(i,f.getCellSize()*-7);
})).append(a('<button type="button" class="nav-link nav-end"/>').html("&gt;&#124;").click(function(){c.navigateTo(i,"end");})).append(a('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){c.zoomInOut(i,-1);
})).append(a('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){c.zoomInOut(i,1);}));}return a('<div class="bottom"/>').append(j);
},createProgressBar:function(p,q,k,o,i,m){var j=f.getCellSize();var n=f.getProgressBarMargin()||0;var l=a('<div class="bar"><div class="fn-label">'+o+"</div></div>").addClass(q).css({width:((j*p)-n)+2}).data("dataObj",i);
if(k){l.mouseover(function(r){var s=a('<div class="fn-gantt-hint" />').html(k);a("body").append(s);s.css("left",r.pageX);s.css("top",r.pageY);s.show();
}).mouseout(function(){a(".fn-gantt-hint").remove();}).mousemove(function(r){a(".fn-gantt-hint").css("left",r.pageX);a(".fn-gantt-hint").css("top",r.pageY+15);
});}l.click(function(r){r.stopPropagation();e.onItemClick(a(this).data("dataObj"));});return l;},markNow:function(i){switch(e.scale){case"weeks":var j=Date.parse(new Date());
j=(Math.floor(j/36400000)*36400000);a(i).find(':findweek("'+j+'")').removeClass("wd").addClass("today");break;case"months":a(i).find(':findmonth("'+new Date().getTime()+'")').removeClass("wd").addClass("today");
break;default:var j=Date.parse(new Date());j=(Math.floor(j/36400000)*36400000);a(i).find(':findday("'+j+'")').removeClass("wd").addClass("today");break;
}},fillData:function(j,k,l){var m=function(r){try{r=r.replace("rgb(","").replace(")","");var t=r.split(",");var p=parseInt(t[0],10);var o=parseInt(t[1],10);
var s=parseInt(t[2],10);var n=Math.round((255-(0.299*p+0.587*o+0.114*s))*0.9);return"rgb("+n+", "+n+", "+n+")";}catch(q){return"";}};var i=function(q){try{q=q.replace("rgb(","").replace(")","");
var s=q.split(",");var o=parseInt(s[0]);var n=parseInt(s[1]);var r=parseInt(s[2]);o=o-Math.round(parseInt(o)/7);n=n-Math.round(parseInt(n)/7);r=r-Math.round(parseInt(r)/7);
return"rgb("+o+", "+n+", "+r+")";}catch(p){return"";}};a.each(j.data,function(n,o){switch(e.multiTaskPerRow){case true:if(o.values[0].cat<=((j.pageNum+1)*e.rowsPerPage-1)&&(o.values[0].cat>(j.pageNum*e.rowsPerPage-1))){a.each(o.values,function(q,z){var E=null;
var t=null;switch(e.scale){case"hours":var s=f.genId(f.dateDeserialize(z.from).getTime(),j.scaleStep);var C=a(j).find("#dh-"+s);var x=f.genId(f.dateDeserialize(z.to).getTime(),j.scaleStep);
var D=a(j).find("#dh-"+x);console.log(s,x);var v=C.attr("offset");var r=D.attr("offset");var u=Math.floor((r-v)/f.getCellSize())+1;E=c.createProgressBar(u,z.id?z.id:"",z.customClass?z.customClass:"",z.desc?z.desc:"",z.label?z.label:"",z.dataObj?z.dataObj:null,z.cat?z.cat:"");
t=(z.cat)?z.cat:n;var w=a(j).find("#rowheader"+t);var y=f.getCellSize()*5+2+parseInt(w.attr("offset"),10);E.css({top:y,left:Math.floor(v)});k.append(E);
break;case"weeks":var B=f.dateDeserialize(z.from);var p=f.dateDeserialize(z.to);if(B.getDate()<=3&&B.getMonth()===0){B.setDate(B.getDate()+4);}if(B.getDate()<=3&&B.getMonth()===0){B.setDate(B.getDate()+4);
}if(p.getDate()<=3&&p.getMonth()===0){p.setDate(p.getDate()+4);}var C=a(j).find("#"+B.getWeekId());var v=C.attr("offset");var D=a(j).find("#"+p.getWeekId());
var r=D.attr("offset");var u=Math.round((r-v)/f.getCellSize())+1;E=c.createProgressBar(u,z.id?z.id:"",z.customClass?z.customClass:"",z.desc?z.desc:"",z.label?z.label:"",z.dataObj?z.dataObj:null,z.cat?z.cat:"");
t=(z.cat)?z.cat:n;var w=a(j).find("#rowheader"+t);var y=f.getCellSize()*3+2+parseInt(w.attr("offset"),10);E.css({top:y,left:Math.floor(v)});k.append(E);
break;case"months":var B=f.dateDeserialize(z.from);var p=f.dateDeserialize(z.to);if(B.getDate()<=3&&B.getMonth()===0){B.setDate(B.getDate()+4);}if(B.getDate()<=3&&B.getMonth()===0){B.setDate(B.getDate()+4);
}if(p.getDate()<=3&&p.getMonth()===0){p.setDate(p.getDate()+4);}var C=a(j).find("#dh-"+f.genId(B.getTime()));var v=C.attr("offset");var D=a(j).find("#dh-"+f.genId(p.getTime()));
var r=D.attr("offset");var u=Math.round((r-v)/f.getCellSize())+1;E=c.createProgressBar(u,z.id?z.id:"",z.customClass?z.customClass:"",z.desc?z.desc:"",z.label?z.label:"",z.dataObj?z.dataObj:null,z.cat?z.cat:"");
t=(z.cat)?z.cat:n;var w=a(j).find("#rowheader"+t);var y=f.getCellSize()*2+2+parseInt(w.attr("offset"),10);E.css({top:y,left:Math.floor(v)});k.append(E);
break;default:var s=f.genId(f.dateDeserialize(z.from).getTime());var x=f.genId(f.dateDeserialize(z.to).getTime());var C=a(j).find("#dh-"+s);var v=C.attr("offset");
var u=Math.floor(((x/1000)-(s/1000))/86400)+1;E=c.createProgressBar(u,z.id?z.id:"",z.customClass?z.customClass:"",z.desc?z.desc:"",z.label?z.label:"",z.dataObj?z.dataObj:null,z.cat?z.cat:"");
t=(z.cat)?z.cat:n;var w=a(j).find("#rowheader"+t);var y=f.getCellSize()*4+2+parseInt(w.attr("offset"),10);E.css({top:y,left:Math.floor(v)});k.append(E);
break;}var A=E.find(".fn-label");if(A&&E.length){var F=m(E[0].style.backgroundColor);A.css("color",F);}else{if(A){A.css("color","");}}});}break;default:if(n>=j.pageNum*e.itemsPerPage&&n<(j.pageNum*e.itemsPerPage+e.itemsPerPage)){a.each(o.values,function(q,y){var D=null;
switch(e.scale){case"hours":var s=f.genId(f.dateDeserialize(y.from).getTime(),j.scaleStep);var B=a(j).find("#dh-"+s);var w=f.genId(f.dateDeserialize(y.to).getTime(),j.scaleStep);
var C=a(j).find("#dh-"+w);console.log(s,w);var u=B.attr("offset");var r=C.attr("offset");var t=Math.floor((r-u)/f.getCellSize())+1;D=c.createProgressBar(t,y.id?y.id:"",y.customClass?y.customClass:"",y.desc?y.desc:"",y.label?y.label:"",y.dataObj?y.dataObj:null);
var v=a(j).find("#rowheader"+n);var x=f.getCellSize()*5+2+parseInt(v.attr("offset"),10);D.css({top:x,left:Math.floor(u)});k.append(D);break;case"weeks":var A=f.dateDeserialize(y.from);
var p=f.dateDeserialize(y.to);if(A.getDate()<=3&&A.getMonth()===0){A.setDate(A.getDate()+4);}if(A.getDate()<=3&&A.getMonth()===0){A.setDate(A.getDate()+4);
}if(p.getDate()<=3&&p.getMonth()===0){p.setDate(p.getDate()+4);}var B=a(j).find("#"+A.getWeekId());var u=B.attr("offset");var C=a(j).find("#"+p.getWeekId());
var r=C.attr("offset");var t=Math.round((r-u)/f.getCellSize())+1;D=c.createProgressBar(t,y.id?y.id:"",y.customClass?y.customClass:"",y.desc?y.desc:"",y.label?y.label:"",y.dataObj?y.dataObj:null);
var v=a(j).find("#rowheader"+n);var x=f.getCellSize()*3+2+parseInt(v.attr("offset"),10);D.css({top:x,left:Math.floor(u)});k.append(D);break;case"months":var A=f.dateDeserialize(y.from);
var p=f.dateDeserialize(y.to);if(A.getDate()<=3&&A.getMonth()===0){A.setDate(A.getDate()+4);}if(A.getDate()<=3&&A.getMonth()===0){A.setDate(A.getDate()+4);
}if(p.getDate()<=3&&p.getMonth()===0){p.setDate(p.getDate()+4);}var B=a(j).find("#dh-"+f.genId(A.getTime()));var u=B.attr("offset");var C=a(j).find("#dh-"+f.genId(p.getTime()));
var r=C.attr("offset");var t=Math.round((r-u)/f.getCellSize())+1;D=c.createProgressBar(t,y.id?y.id:"",y.customClass?y.customClass:"",y.desc?y.desc:"",y.label?y.label:"",y.dataObj?y.dataObj:null);
var v=a(j).find("#rowheader"+n);var x=f.getCellSize()*2+2+parseInt(v.attr("offset"),10);D.css({top:x,left:Math.floor(u)});k.append(D);break;default:var s=f.genId(f.dateDeserialize(y.from).getTime());
var w=f.genId(f.dateDeserialize(y.to).getTime());var B=a(j).find("#dh-"+s);var u=B.attr("offset");var t=Math.floor(((w/1000)-(s/1000))/86400)+1;D=c.createProgressBar(t,y.id?y.id:"",y.customClass?y.customClass:"",y.desc?y.desc:"",y.label?y.label:"",y.dataObj?y.dataObj:null);
var v=a(j).find("#rowheader"+n);var x=f.getCellSize()*4+2+parseInt(v.attr("offset"),10);D.css({top:x,left:Math.floor(u)});k.append(D);break;}var z=D.find(".fn-label");
if(z&&D.length){var E=m(D[0].style.backgroundColor);z.css("color",E);}else{if(z){z.css("color","");}}});}break;}});},navigateTo:function(n,k){var l=a(n).find(".fn-gantt .rightPanel");
var i=l.find(".dataPanel");i.click=function(){alert(arguments.join(""));};var o=l.width();var m=i.width();switch(k){case"begin":i.animate({"margin-left":"0px"},"fast",function(){c.repositionLabel(n);
});n.scrollNavigation.panelMargin=0;break;case"end":var j=m-o;n.scrollNavigation.panelMargin=j*-1;i.animate({"margin-left":"-"+j+"px"},"fast",function(){c.repositionLabel(n);
});break;case"now":if(!n.scrollNavigation.canScroll||!i.find(".today").length){return false;}var p=(m-o)*-1;var q=i.css("margin-left").replace("px","");
var k=i.find(".today").offset().left-i.offset().left;k*=-1;if(k>0){k=0;}else{if(k<p){k=p;}}i.animate({"margin-left":k+"px"},"fast",c.repositionLabel(n));
n.scrollNavigation.panelMargin=k;break;default:var p=(m-o)*-1;var q=i.css("margin-left").replace("px","");var k=parseInt(q,10)+k;if(k<=0&&k>=p){i.animate({"margin-left":k+"px"},"fast",c.repositionLabel(n));
}n.scrollNavigation.panelMargin=k;break;}c.synchronizeScroller(n);},navigatePage:function(i,j){switch(e.multiTaskPerRow){case true:if((i.pageNum+j>=0)&&(i.pageNum+j)<Math.ceil(e.categoryAmount/e.rowsPerPage)){c.waitToggle(i,true,function(){i.pageNum+=j;
i.hPosition=a(".fn-gantt .dataPanel").css("margin-left").replace("px","");i.scaleOldWidth=false;c.init(i);});}break;default:if((i.pageNum+j)>=0&&(i.pageNum+j)<Math.ceil(i.rowsNum/e.itemsPerPage)){c.waitToggle(i,true,function(){i.pageNum+=j;
i.hPosition=a(".fn-gantt .dataPanel").css("margin-left").replace("px","");i.scaleOldWidth=false;c.init(i);});}break;}},zoomInOut:function(i,j){c.waitToggle(i,true,function(){var p=(j<0);
var n=i.scaleStep+j*3;n=n<=1?1:n===4?3:n;var m=e.scale;var k=i.headerRows;if(e.scale==="hours"&&n>=13){m="days";k=4;n=13;}else{if(e.scale==="days"&&p){m="hours";
k=5;n=12;}else{if(e.scale==="days"&&!p){m="weeks";k=3;n=13;}else{if(e.scale==="weeks"&&!p){m="months";k=2;n=14;}else{if(e.scale==="weeks"&&p){m="days";
k=4;n=13;}else{if(e.scale==="months"&&p){m="weeks";k=3;n=13;}}}}}}if((p&&a.inArray(m,g)<a.inArray(e.minScale,g))||(!p&&a.inArray(m,g)>a.inArray(e.maxScale,g))){c.init(i);
return;}i.scaleStep=n;e.scale=m;i.headerRows=k;var l=a(i).find(".fn-gantt .rightPanel");var o=l.find(".dataPanel");i.hPosition=o.css("margin-left").replace("px","");
i.scaleOldWidth=(o.width()-l.width());if(e.useCookie){a.cookie(this.cookieKey+"CurrentScale",e.scale);a.cookie(this.cookieKey+"ScrollPos",null);}c.init(i);
});},mouseScroll:function(i,j){var n=a(i).find(".fn-gantt .dataPanel");n.css("cursor","move");var l=n.offset();var k=i.scrollNavigation.mouseX===null?j.pageX:i.scrollNavigation.mouseX;
var m=j.pageX-k;i.scrollNavigation.mouseX=j.pageX;c.scrollPanel(i,m);clearTimeout(i.scrollNavigation.repositionDelay);i.scrollNavigation.repositionDelay=setTimeout(c.repositionLabel,50,i);
},wheelScroll:function(i,j){j.preventDefault();var k=j.detail?j.detail*(-50):j.wheelDelta/120*50;c.scrollPanel(i,k);clearTimeout(i.scrollNavigation.repositionDelay);
i.scrollNavigation.repositionDelay=setTimeout(c.repositionLabel,50,i);},sliderScroll:function(n,p){var s=a(n).find(".nav-slider-bar");var r=s.find(".nav-slider-button");
var m=a(n).find(".fn-gantt .rightPanel");var j=m.find(".dataPanel");var k=s.offset();var t=s.width();var l=r.width();var q,i;if((p.pageX>=k.left)&&(p.pageX<=k.left+t)){q=p.pageX-k.left;
q=q-l/2;r.css("left",q);i=j.width()-m.width();var o=q*i/t*-1;if(o>=0){j.css("margin-left","0px");n.scrollNavigation.panelMargin=0;}else{if(q>=t-(l*1)){j.css("margin-left",i*-1+"px");
n.scrollNavigation.panelMargin=i*-1;}else{j.css("margin-left",o+"px");n.scrollNavigation.panelMargin=o;}}clearTimeout(n.scrollNavigation.repositionDelay);
n.scrollNavigation.repositionDelay=setTimeout(c.repositionLabel,5,n);}},scrollPanel:function(i,k){if(!i.scrollNavigation.canScroll){return false;}var j=parseInt(i.scrollNavigation.panelMargin,10)+k;
if(j>0){i.scrollNavigation.panelMargin=0;a(i).find(".fn-gantt .dataPanel").css("margin-left",i.scrollNavigation.panelMargin+"px");}else{if(j<i.scrollNavigation.panelMaxPos*-1){i.scrollNavigation.panelMargin=i.scrollNavigation.panelMaxPos*-1;
a(i).find(".fn-gantt .dataPanel").css("margin-left",i.scrollNavigation.panelMargin+"px");}else{i.scrollNavigation.panelMargin=j;a(i).find(".fn-gantt .dataPanel").css("margin-left",i.scrollNavigation.panelMargin+"px");
}}c.synchronizeScroller(i);},synchronizeScroller:function(m){if(e.navigate==="scroll"){var l=a(m).find(".fn-gantt .rightPanel");var i=l.find(".dataPanel");
var q=a(m).find(".nav-slider-bar");var n=q.find(".nav-slider-button");var r=q.width();var k=n.width();var j=i.width()-l.width();var o=0;if(i.css("margin-left")){o=i.css("margin-left").replace("px","");
}var p=o*r/j-n.width()*0.25;p=p>0?0:(p*-1>=r-(k*0.75))?(r-(k*1.25))*-1:p;n.css("left",p*-1);}},repositionLabel:function(i){setTimeout(function(){var k;
if(!i){k=a(".fn-gantt .rightPanel .dataPanel");}else{var j=a(i).find(".fn-gantt .rightPanel");k=j.find(".dataPanel");}if(e.useCookie){a.cookie(this.cookieKey+"ScrollPos",k.css("margin-left").replace("px",""));
}},500);c.synchronizeScroller(i);},waitToggle:function(k,i,m){if(i){var j=a(k).offset();var l=a(k).outerWidth();var n=a(k).outerHeight();if(!k.loader){k.loader=a('<div class="fn-gantt-loader"><div class="fn-gantt-loader-spinner"><span>'+e.waitText+"</span></div></div>");
}a(k).append(k.loader);setTimeout(m,500);}else{if(k.loader){k.loader.detach();}}}};var f={getMaxDate:function(i){var l=null;a.each(i.data,function(m,n){a.each(n.values,function(p,o){l=l<f.dateDeserialize(o.to)?f.dateDeserialize(o.to):l;
});});l=l||new Date();switch(e.scale){case"hours":l.setHours(Math.ceil((l.getHours())/i.scaleStep)*i.scaleStep);l.setHours(l.getHours()+i.scaleStep*3);
break;case"weeks":var k=new Date(l.getTime());var k=new Date(k.setDate(k.getDate()+3*7));var j=Math.floor(k.getDate()/7)*7;l=new Date(k.getFullYear(),k.getMonth(),j===0?4:j-3);
break;case"months":var k=new Date(l.getFullYear(),l.getMonth(),1);k.setMonth(k.getMonth()+2);l=new Date(k.getFullYear(),k.getMonth(),1);break;default:l.setHours(0);
l.setDate(l.getDate()+3);break;}return l;},getMinDate:function(i){var l=null;a.each(i.data,function(m,n){a.each(n.values,function(p,o){l=l>f.dateDeserialize(o.from)||l===null?f.dateDeserialize(o.from):l;
});});l=l||new Date();switch(e.scale){case"hours":l.setHours(Math.floor((l.getHours())/i.scaleStep)*i.scaleStep);l.setHours(l.getHours()-i.scaleStep*3);
break;case"weeks":var k=new Date(l.getTime());var k=new Date(k.setDate(k.getDate()-3*7));var j=Math.floor(k.getDate()/7)*7;l=new Date(k.getFullYear(),k.getMonth(),j===0?4:j-3);
break;case"months":var k=new Date(l.getFullYear(),l.getMonth(),1);k.setMonth(k.getMonth()-3);l=new Date(k.getFullYear(),k.getMonth(),1);break;default:l.setHours(0);
l.setDate(l.getDate()-3);break;}return l;},parseDateRange:function(o,n){var m=new Date(o.getTime());var j=new Date(n.getTime());var k=[];var l=0;do{k[l++]=new Date(m.getTime());
m.setDate(m.getDate()+1);}while(m.getTime()<=n.getTime());return k;},parseTimeRange:function(q,p,l){var o=new Date(q);var k=new Date(p);o.setMilliseconds(0);
o.setSeconds(0);o.setMinutes(0);o.setHours(0);k.setMilliseconds(0);k.setSeconds(0);if(k.getMinutes()>0||k.getHours()>0){k.setMinutes(0);k.setHours(0);k.setTime(k.getTime()+(86400000));
}var m=[];var n=0;for(;;){var j=new Date(o);j.setHours(Math.floor((o.getHours())/l)*l);if(m[n]&&j.getDay()!==m[n].getDay()){j.setHours(0);}m[n]=j;if(o.getTime()>p.getTime()){break;
}o=b(j,l);n++;}return m;},parseWeeksRange:function(o,n){var m=new Date(o);var j=new Date(n);var k=[];var l=0;do{if(m.getDay()===0){k[l++]=m.getDayForWeek();
}m.setDate(m.getDate()+1);}while(m.getTime()<=n.getTime());return k;},parseMonthsRange:function(o,n){var m=new Date(o);var j=new Date(n);var k=[];var l=0;
do{k[l++]=new Date(m.getFullYear(),m.getMonth(),1);m.setMonth(m.getMonth()+1);}while(m.getTime()<=n.getTime());return k;},dateDeserialize:function(i){if(typeof i==="string"){i=i.replace(/\/Date\((.*)\)\//,"$1");
i=a.isNumeric(i)?parseInt(i,10):a.trim(i);}return new Date(i);},genId:function(n){var l=new Date(n);switch(e.scale){case"hours":var k=l.getHours();if(arguments.length>=2){k=(Math.floor((l.getHours())/arguments[1])*arguments[1]);
}return(new Date(l.getFullYear(),l.getMonth(),l.getDate(),k)).getTime();case"weeks":var o=l.getFullYear();var j=l.getDayForWeek().getWeekOfYear();var i=l.getMonth();
if(i===11&&j===1){o++;}return o+"-"+j;case"months":return l.getFullYear()+"-"+l.getMonth();default:return(new Date(l.getFullYear(),l.getMonth(),l.getDate())).getTime();
}},_datesToDays:function(n){var m={};for(var l=0,j=n.length,k;l<j;l++){k=f.dateDeserialize(n[l]);m[k.setHours(0,0,0,0)]=true;}return m;},isHoliday:(function(){if(!e.holidays){return function(){return false;
};}var i=false;return function(j){if(!i){i=f._datesToDays(e.holidays);}return !!i[a.isNumeric(j)?j:(new Date(j.getFullYear(),j.getMonth(),j.getDate())).getTime()];
};})(),_getCellSize:null,getCellSize:function(){if(!f._getCellSize){a("body").append(a('<div style="display: none; position: absolute;" class="fn-gantt" id="measureCellWidth"><div class="row"></div></div>'));
f._getCellSize=a("#measureCellWidth .row").height();a("#measureCellWidth").empty().remove();}return f._getCellSize;},getRightPanelSize:function(){a("body").append(a('<div style="display: none; position: absolute;" class="fn-gantt" id="measureCellWidth"><div class="rightPanel"></div></div>'));
var i=a("#measureCellWidth .rightPanel").height();a("#measureCellWidth").empty().remove();return i;},getPageHeight:function(i){switch(e.multiTaskPerRow){case true:return i.pageNum+1===i.pageCount?i.rowsOnLastPage*f.getCellSize():e.rowsPerPage*f.getCellSize();
default:return i.pageNum+1===i.pageCount?i.rowsOnLastPage*f.getCellSize():e.itemsPerPage*f.getCellSize();}},_getProgressBarMargin:null,getProgressBarMargin:function(){if(!f._getProgressBarMargin&&f._getProgressBarMargin!==0){a("body").append(a('<div style="display: none; position: absolute;" id="measureBarWidth" ><div class="fn-gantt"><div class="rightPanel"><div class="dataPanel"><div class="row day"><div class="bar" /></div></div></div></div></div>'));
f._getProgressBarMargin=parseInt(a("#measureBarWidth .fn-gantt .rightPanel .day .bar").css("margin-left").replace("px",""),10);f._getProgressBarMargin+=parseInt(a("#measureBarWidth .fn-gantt .rightPanel .day .bar").css("margin-right").replace("px",""),10);
a("#measureBarWidth").empty().remove();}return f._getProgressBarMargin;}};this.each(function(){this.data=null;this.pageNum=0;this.pageCount=0;this.rowsOnLastPage=0;
this.rowsNum=0;this.hPosition=0;this.dateStart=null;this.dateEnd=null;this.scrollClicked=false;this.scaleOldWidth=null;this.headerRows=null;if(e.useCookie){var i=a.cookie(this.cookieKey+"CurrentScale");
if(i){e.scale=a.cookie(this.cookieKey+"CurrentScale");}else{a.cookie(this.cookieKey+"CurrentScale",e.scale);}}switch(e.scale){case"hours":this.headerRows=5;
this.scaleStep=1;break;case"weeks":this.headerRows=3;this.scaleStep=13;break;case"months":this.headerRows=2;this.scaleStep=14;break;default:this.headerRows=4;
this.scaleStep=13;break;}this.scrollNavigation={panelMouseDown:false,scrollerMouseDown:false,mouseX:null,panelMargin:0,repositionDelay:0,panelMaxPos:0,canScroll:true};
this.gantt=null;this.loader=null;c.create(this);});};})(jQuery);